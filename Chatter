function ChatterController(n,t){this.chatter=n;this.printer=t;this.currentLanguage=navigator.language||navigator.userLanguage||navigator.languages;this.liveAgent=!1;this.systemName=null;this.currentLanguage!="zh-CHS"&&(this.currentLanguage=this.currentLanguage.split("-")[0])}function MessagePrinter(n){this.robotIcon="face-robot.png";this.userIcon="default-user-icon-profile.png";this.userMessageAlign="right";this.robotMessageAlign="left";this.div=n}function ICommand(){this.executeCommand=!1}function ImgCommand(n){ICommand.call(this);this.responseText=[];this.controller=n}function LoadSite(n,t,i){var f=n.split(" "),h=f[1].replace("url=",""),c=f[2].replace("index=",""),o=f[3].replace("tag=",""),e="UTF-8",s=3,r,u;n.indexOf("encoding")>=0&&(e=f[4].replace("encoding=",""),s=4);r="";u=0;f.forEach(function(n){u<=s?u++:(r+=" "+n,u++)});r=r.replace("]","").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"');r.indexOf("Depuração")>=0&&(r=r.substring(0,r.indexOf("Depuração")));$.ajax({url:decodeURIComponent(escape(h)),type:"GET",async:!1,crossDomain:!0,dataType:"html",contentType:"text/html; charset="+e,mimeType:"text/html; charset="+e,success:function(n){var e=new XRegExp("<"+o+".*?"+r.replace(/^\s+/,"").trim()+".*?>([\\s\\S]*?)<\/"+o+">"),f="";u=1;XRegExp.forEach(n.responseText,e,function(n){u==c&&(f=n[0]);u++});f=f.replace(/<\/?[^>]+(>|$)/g,"");ReceiveMessage(f,t,i)},error:function(){console.log("Erro ao pesquisar no site.")}})}function PhoneCommand(n){ICommand.call(this);this.responseText=[];this.controller=n}function LinkCommand(n){ICommand.call(this);this.responseText=[];this.controller=n}function desativa(){var n=$(".btn-info");n.attr("disabled",!0);n.addClass("desativado")}function esconde(){var n=$(".area-resposta-cards");n.click(this).addClass("disabled")}function multiplaescolha(){for(var t=document.getElementsByName("escolhas"),i=[],n=0;n<t.length;n++)t[n].checked&&i.push(t[n].value);document.getElementById("txtQuestion").value=i}function NewLineCommand(n){ICommand.call(this);this.responseText=[];this.controller=n}function PasswordCommand(n){ICommand.call(this);this.controller=n}function UploadCommand(n){ICommand.call(this);this.responseText=[];this.controller=n;this.userLang=navigator.language||navigator.userLanguage||navigator.languages;this.userLang!="zh-CHS"&&(this.userLang=this.userLang.split("-")[0])}function printFileNames(n){if(n==lastUploadsControls){filesUpload.length<=controller.chatter.uploadFileParameters.fileMaxQty&&($("#error"+n).html(""),$("#error"+n).hide());$("#userFile"+n).parent().parent().height(defaultHeight);$("#filesToUpload"+n).empty();$("#filesToUpload"+n).height(0);for(var t=0;t<filesUpload.length;t++)window.FormData!=undefined?$("#filesToUpload"+n).append('<a class="bt-close" id="linkFile'+n+"_"+t+'" href="javascript:removeFile('+t+","+n+');"><i class="fa fa-times-circle btn-cancelUp" aria-hidden="true" /><\/a><span style="font-weight:normal!important;'+(filesUpload[t].size>controller.chatter.uploadFileParameters.fileMaxSize?"color:red;":"")+'">'+filesUpload[t].name+"<\/span><br />"):$("#filesToUpload"+n).append('<a class="bt-close" id="linkFile'+n+"_"+t+'" href="javascript:removeFile('+t+","+n+');"><i class="fa fa-times-circle btn-cancelUp" aria-hidden="true" /><\/a><span style="font-weight:normal!important;'+(filesUpload[t].size>controller.chatter.uploadFileParameters.fileMaxSize?"color:red;":"")+'">'+filesUpload[t]+"<\/span><br />"),t<controller.chatter.uploadFileParameters.filesWithoutScroll&&($("#filesToUpload"+n).height($("#filesToUpload"+n).height()+17),$("#userFile"+n).parent().parent().height($("#userFile"+n).parent().parent().height()+17));window.scrollTo(0,document.body.scrollHeight)}}function changeFileList(n){var t,i;if(n==lastUploadsControls){if(t=document.getElementById("userFile"+n),t.value=="")return;if(filesUpload!=null&&filesUpload.length==0&&(defaultHeight=$("#userFile"+n).parent().parent().height()),$("#userFile"+n)[0].multiple&&filesUpload!=null&&filesUpload.length>0&&$("#userFile"+n)[0].files.length+filesUpload.length>controller.chatter.uploadFileParameters.fileMaxQty){$("#userFile"+n).parent().parent().height($("#userFile"+n).parent().parent().height()+10);$("#error"+n).html(controller.chatter.uploadFileParameters.fileMaxQtyError+controller.chatter.uploadFileParameters.fileMaxQty);$("#error"+n).show();t.value="";t.type="";t.type="file";return}if($("#userFile"+n)[0].multiple||(filesUpload=[]),"files"in t)for(i=0;i<t.files.length;i++)filesUpload.push(t.files[i]);else filesUpload.push($("#userFile"+n).val());printFileNames(n);window.FormData!=undefined&&(t.value="",t.type="",t.type="file")}}function uploadFiles(n){var u,r,t,f,i;if(n==lastUploadsControls)if(u=!1,window.FormData==undefined)$("#userFile"+n).val()!=""&&filesUpload!=null&&filesUpload.length>0&&($("#userFile"+n).parent().parent().height($("#userFile"+n).parent().parent().height()+10),$("#progressbar"+n).show(),timeFileUpload=window.setInterval(function(){loadMsg(n)},500),r=null,document.getElementById("postIframe"+n)==null&&(r=$('<iframe name="postIframe'+n+'" id="postIframe'+n+'" style="display: none"><\/iframe>'),$("body").append(r)),r=document.getElementById("postIframe"+n),$("body").append(r),t=$("#form2"),t.attr("action",contentDir+"../api/UploadFile/UploadFile?sessionId="+controller.chatter.sessionId+"&controlId="+n),t.attr("method","post"),t.attr("encoding","multipart/form-data"),t.attr("enctype","multipart/form-data"),t.attr("target","postIframe"+n),t.attr("file",$("#userFile"+n).val()),t.submit(),$("#postIframe"+n).load(function(){iframeContents=this.contentWindow.document.body.innerHTML;eventsAfterUpload(iframeContents,n)}));else if(filesUpload!=null&&filesUpload.length>0){for(u=!1,i=0;i<filesUpload.length;i++)filesUpload[i].size>controller.chatter.uploadFileParameters.fileMaxSize&&(u=!0);if(u){$("#userFile"+n).parent().parent().height($("#userFile"+n).parent().parent().height()+10);$("#error"+n).html(controller.chatter.uploadFileParameters.fileMaxSizeError+controller.chatter.uploadFileParameters.fileMaxSize/1048576+"MB");$("#error"+n).show();return}for($("#userFile"+n).parent().parent().height($("#userFile"+n).parent().parent().height()+10),$("#progressbar"+n).show(),$("#error"+n).hide(),timeFileUpload=window.setInterval(function(){loadMsg(n)},500),f=new FormData,i=0;i<filesUpload.length;i++)f.append("file",filesUpload[i]);$.ajax({url:contentDir+"../api/UploadFile/UploadFile?sessionId="+controller.chatter.sessionId,crossDomain:!0,cache:!1,contentType:!1,processData:!1,data:f,method:"post",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload.onprogress=function(t){t.lengthComputable&&(percentage=(t.loaded/t.total*100).toFixed(0),clearInterval(timeFileUpload),$("#progressbar"+n).children().first().css("width",percentage+"%"),$("#progressbar"+n).children().first().text(percentage+"%"))},t}}).done(function(t){eventsAfterUpload(t,n)}).fail(function(){controller.sendMessage(controller.chatter.uploadFileParameters.msgUploadSucess,controller.chatter.uploadFileParameters.msgUploadSucess,!1)})}}function removeFile(n,t){t==lastUploadsControls&&($("#btSelectFiles"+t).prop("disabled")||(filesUpload!=null&&filesUpload.length>=n+1&&filesUpload.splice(n,1),printFileNames(t)))}function clearFiles(n){if(n==lastUploadsControls){var t=document.getElementById("userFile"+n);t.value="";t.type="";t.type="file";$("#filesToUpload"+n).empty();filesUpload=[];$("#userFile"+n).parent().parent().height(defaultHeight);$("#error"+n).hide();$("#filesToUpload"+n).height(0)}}function checkActualControl(n){return n!=lastUploadsControls?!1:!0}function notSend(n){n==lastUploadsControls&&($("#txtQuestion").prop("disabled",!1),$("#btnSend").prop("disabled",!1),$("#filesToUpload"+n+" a").click(function(n){n.preventDefault()}),$("#userFile"+n).prop("disabled",!0),$("#formsubmit"+n).prop("disabled",!0),$("#btSelectFiles"+n).prop("disabled",!0),$("#btNotSend"+n).prop("disabled",!0),controller.sendMessage(controller.chatter.uploadFileParameters.msgFileNotSent,controller.chatter.uploadFileParameters.msgFileNotSent,!1),clearInterval(timeFileUpload))}function eventsAfterUpload(n,t){clearInterval(timeFileUpload);var i="";$("#filesToUpload"+t+" a").click(function(n){n.preventDefault()});$("#userFile"+t).prop("disabled",!0);$("#formsubmit"+t).prop("disabled",!0);$("#btSelectFiles"+t).prop("disabled",!0);$("#btNotSend"+t).prop("disabled",!0);$("#txtQuestion").prop("disabled",!1);$("#btnSend").prop("disabled",!1);n==200?i=controller.chatter.uploadFileParameters.msgUploadSucess:($("#progressbar"+t).hide(),$("#progressbar"+t).children().first().css("width","0%"),i=controller.chatter.uploadFileParameters.msgUploadSucess);controller.sendMessage(i,i,!1)}function loadMsg(n){var r=document.getElementById("spanProgress"+n),t=translation[controller.currentLanguage].sendingFiles,i;iTimer++;iTimer==1?t=t+".":iTimer==2?t=t+"..":iTimer==3&&(t=t+"...",iTimer=0);i=document.createTextNode(t);r.innerText=i.textContent}function MultiSelectCommand(n){ICommand.call(this);this.responseText=[];this.controller=n;this.userLang=navigator.language||navigator.userLanguage||navigator.languages;this.userLang!="zh-CHS"&&(this.userLang=this.userLang.split("-")[0])}function sendQuestions(){var n,t;disabelMultiSelect();eventDisableComponents(!1);n=[];$.each($(".OptionsTag:checked"),function(){n.push($(this).val())});t=n.join(";");this.controller.sendMessage(t,t,!1);return}function cancelQuestions(){disabelMultiSelect();eventDisableComponents(!1);this.controller.sendMessage("escapeflow","escapeflow",!1);return}function disabelMultiSelect(){$("input.btnQuestionSubmit").prop("disabled",!0);$("input.btnQuestionCancel").prop("disabled",!0);$("div.checkbox .OptionsTag").attr("disabled",!0)}function eventDisableComponents(n){$("#btnSend").prop("disabled",n);$("#txtQuestion").prop("disabled",n)}ChatterController.prototype.sendMessage=function(n,t,i,r,u){if((u===NaN||u===undefined||u==="")&&(u=!0),t!=""){i&&this.printer.createDivMessage(this.chatter.systemName,this.chatter.userInfo.userName,n);!this.liveAgent&&u&&this.statusConversation("writing");this.chatter.userText=t;this.chatter.botText="";this.chatter.userLanguage=r;var f=new FormData;u?$.ajax({url:rootDir+"GetConversation",cache:!1,data:this.chatter,method:"POST",context:this,error:function(n){this.statusConversation("offline");console.log("Error getting answer of the question. Error: "+n)}}):$.ajax({url:rootDir+"Respond",cache:!1,contentType:"application/json; charset=utf-8",data:'{"sessionID":"'+this.chatter.sessionId+'","userInput":"'+t+'","language":"'+r+"}",datatype:"json",method:"POST",error:function(n){this.statusConversation("offline");console.log("Error getting answer of the question. Error: "+n)}});$("#LiveAgentBtnStart")&&(this.liveAgent?showEndBtn():showStartBtn())}};ChatterController.prototype.receiveMessage=function(n){var t,r,i;if(this.chatter.botText=n.botText.replace("[c:skypestarted]",""),this.chatter.userLanguage=n.userLanguage,this.liveAgent=/true/i.test(n.liveAgent),this.pw=!1,n.agentName&&!this.systemName?(this.systemName=this.chatter.systemName,this.chatter.systemName=n.agentName):!n.agentName&&this.systemName&&(this.chatter.systemName=this.systemName,this.systemName=null),controller.chatter.botText!="")for(t=[],t.push(new PhoneCommand(controller)),t.push(new LinkCommand(this)),t.push(new NewLineCommand(this)),t.push(new ImgCommand(this)),t.push(new PasswordCommand(this)),t.push(new UploadCommand(this)),t.push(new MultiSelectCommand(controller)),r=[],i=0;i<t.length;i++)t[i].isMyCommand()&&t[i].execute();this.chatter.botText.split("[c:newdialog]").forEach(function(n){if(n.indexOf("[@user@]")>0){if(n.indexOf("[@user@]startup")==-1){var t=n.replace("[@user@]","");controller.printer.createDivMessage(controller.chatter.systemName,"user",t,controller.pw)}}else n.trim()!=""&&controller.printer.createDivMessage(controller.chatter.systemName,"bot",n,controller.pw)});this.chatter.userLanguage!==this.currentLanguage&&this.refreshLanguage();this.statusConversation("online");checkForAgent()};ChatterController.prototype.statusConversation=function(n){n=="writing"?(this.printer.createWritingDiv(),this.updateStatusView(this.chatter.systemName+translation[this.currentLanguage].isWriting)):n=="online"?(this.printer.removeWritingDiv(),this.updateStatusView(translation[this.currentLanguage].pleaseType)):n=="sending"?(this.printer.removeWritingDiv(),this.updateStatusView(translation[this.currentLanguage].sending)):(this.printer.removeWritingDiv(),this.updateStatusView(translation[this.currentLanguage].isOffline))};ChatterController.prototype.updateStatusView=function(n){$('div[data-chatter="bot-status"]').text(n)};ChatterController.prototype.timeoutCall=function(){this.sendMessage("timeoutcall","timeoutcall",!1)};ChatterController.prototype.refreshLanguage=function(){this.currentLanguage in translation?($("#headerTitle").text(translation[this.currentLanguage].title),$("#btnSend").text(translation[this.currentLanguage].send),$("#txtQuestion").attr("placeholder",translation[this.currentLanguage].questionPlaceHolder),$("#h6Logoff").html(translation[this.currentLanguage].logoff),$("#h6TitleChatter").html(translation[this.currentLanguage].title)):this.currentLanguage="en"};"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});MessagePrinter.prototype.createDivMessage=function(systemName,who,text,pw){var messageBox;this.removeWritingDiv();$(".suggestions-box:not(.closed)").each(function(){ToggleSuggestionBox($(this).children(".suggestion-button")[0])});var reSuggestions=new RegExp('<a href="javascript:;"[\\s\\S]*<\/a>'),reRemoveBr=new RegExp("^<br/>"),suggestions="";reSuggestions.test(text)&&(suggestions=reSuggestions.exec(text)[0],text=text.replace(suggestions,""),suggestions=suggestions.replace(reRemoveBr,""));var currentdate=new Date,time=currentdate.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),align="",image="";who=="bot"?(align=this.robotMessageAlign,image=this.robotIcon,who=systemName):(align=this.userMessageAlign,image=this.userIcon,text=text.replace(/\[s:useful ruleId=[0-9]+ opinion=[0-9]\]/gi,""));this.flagpw!=!0||pw||(text=(new PasswordCommand).changetext(text));messageBox=this.createMessageBox(align,image,who,systemName,text,suggestions,time);$(this.div)[0].appendChild(messageBox);eval($(messageBox).find("script").text());$("#chatterDiv").animate({scrollTop:$("#chatterDiv").prop("scrollHeight")},"0");(new PasswordCommand).changediv(pw);this.flagpw=pw};MessagePrinter.prototype.createWritingDiv=function(){var o="",s="",t,i,r,n,u,f,e;this.removeWritingDiv();o=this.robotMessageAlign;s=this.robotIcon;t=document.createElement("div");t.setAttribute("id","writingDiv");t.setAttribute("class","row message-box");i=document.createElement("div");i.setAttribute("class","col-md-6 col-xs-11");r=document.createElement("div");r.setAttribute("class","bubble-left");n=document.createElement("div");n.setAttribute("class","typings");u=document.createElement("span");u.setAttribute("class","typing1");f=document.createElement("span");f.setAttribute("class","typing2");e=document.createElement("span");e.setAttribute("class","typing3");n.appendChild(u);n.appendChild(f);n.appendChild(e);r.appendChild(n);i.appendChild(r);t.appendChild(i);$(this.div)[0].appendChild(t);$("#chatterDiv").animate({scrollTop:$("#chatterDiv").prop("scrollHeight")},"0")};MessagePrinter.prototype.removeWritingDiv=function(){if(document.getElementById("writingDiv")!=undefined){var n=document.getElementById("writingDiv");n.parentNode.removeChild(n)}clearInterval(this.timeWritingDots)};MessagePrinter.prototype.createMessageBox=function(n,t,i,r,u,f,e){var c=document.createElement("div"),o,s,h,l;return c.setAttribute("class","row "+n),c.setAttribute("style","margin-right: 0px"),o=document.createElement("div"),o.setAttribute("class","col-xs-11"),s=document.createElement("div"),s.setAttribute("class","bubble-"+n),o.appendChild(s),h=document.createElement("div"),h.setAttribute("style","display: inline-block; width: 80%;"),h.innerHTML="<p "+(i==r?"class='bot-name'":"class='user-name'")+">"+i+"<\/p> <p>"+u+"<\/p>",n=="left"?h.appendChild(this.createTimesStamp("txt-data",e)):(h.appendChild(this.createTimesStamp("txt-data-r",e)),l=document.createElement("div"),l.setAttribute("style","width: 20%; float: right;"),s.appendChild(l)),s.appendChild(h),o.appendChild(s),f!=""&&o.appendChild(this.createSuggestion(f)),c.appendChild(o),c};MessagePrinter.prototype.createPicture=function(n){var t=document.createElement("img");return t.setAttribute("alt","User"),t.setAttribute("style","max-height: 65px; padding-bottom: 5px;"),t.setAttribute("src",contentDir+"images/"+n),t.setAttribute("onerror","\"this.src = 'Default.jpg'\""),t};MessagePrinter.prototype.createTitle=function(n,t){var i=document.createElement("span");return i.setAttribute("class",n==t?"bot-name":"user-name"),i.innerText=n,i};MessagePrinter.prototype.createTimesStamp=function(n,t){var i=document.createElement("p");return i.setAttribute("class","text-left "+n),i.innerText=t,i};MessagePrinter.prototype.createSuggestion=function(n){var t=document.createElement("div");return t.setAttribute("class","area-resposta"),t.innerHTML=n,t};!function(n,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var i={exports:{}};t(i,i.exports);n.autosize=i.exports}}(this,function(n,t){"use strict";function o(n){function l(t){var i=n.style.width;n.style.width="0px";n.offsetWidth;n.style.width=i;n.style.overflowY=t}function o(){if(0!==n.scrollHeight){var i=function(n){for(var t=[];n&&n.parentNode&&n.parentNode instanceof Element;)n.parentNode.scrollTop&&t.push({node:n.parentNode,scrollTop:n.parentNode.scrollTop}),n=n.parentNode;return t}(n),t=document.documentElement&&document.documentElement.scrollTop;n.style.height="";n.style.height=n.scrollHeight+r+"px";s=n.clientWidth;i.forEach(function(n){n.node.scrollTop=n.scrollTop});t&&(document.documentElement.scrollTop=t)}}function t(){var r;o();var u=Math.round(parseFloat(n.style.height)),t=window.getComputedStyle(n,null),i="content-box"===t.boxSizing?Math.round(parseFloat(t.height)):n.offsetHeight;if(i<u?"hidden"===t.overflowY&&(l("scroll"),o(),i="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight):"hidden"!==t.overflowY&&(l("hidden"),o(),i="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight),h!==i){h=i;r=e("autosize:resized");try{n.dispatchEvent(r)}catch(u){}}}if(n&&n.nodeName&&"TEXTAREA"===n.nodeName&&!u.has(n)){var i,r=null,s=null,h=null,c=function(){n.clientWidth!==s&&t()},f=function(i){window.removeEventListener("resize",c,!1);n.removeEventListener("input",t,!1);n.removeEventListener("keyup",t,!1);n.removeEventListener("autosize:destroy",f,!1);n.removeEventListener("autosize:update",t,!1);Object.keys(i).forEach(function(t){n.style[t]=i[t]});u.delete(n)}.bind(n,{height:n.style.height,resize:n.style.resize,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap});n.addEventListener("autosize:destroy",f,!1);"onpropertychange"in n&&"oninput"in n&&n.addEventListener("keyup",t,!1);window.addEventListener("resize",c,!1);n.addEventListener("input",t,!1);n.addEventListener("autosize:update",t,!1);n.style.overflowX="hidden";n.style.wordWrap="break-word";u.set(n,{destroy:f,update:t});"vertical"===(i=window.getComputedStyle(n,null)).resize?n.style.resize="none":"both"===i.resize&&(n.style.resize="horizontal");r="content-box"===i.boxSizing?-(parseFloat(i.paddingTop)+parseFloat(i.paddingBottom)):parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth);isNaN(r)&&(r=0);t()}}function s(n){var t=u.get(n);t&&t.destroy()}function h(n){var t=u.get(n);t&&t.update()}var i,f,u="function"==typeof Map?new Map:(i=[],f=[],{has:function(n){return-1<i.indexOf(n)},get:function(n){return f[i.indexOf(n)]},set:function(n,t){-1===i.indexOf(n)&&(i.push(n),f.push(t))},"delete":function(n){var t=i.indexOf(n);-1<t&&(i.splice(t,1),f.splice(t,1))}}),e=function(n){return new Event(n,{bubbles:!0})},r;try{new Event("test")}catch(n){e=function(n){var t=document.createEvent("Event");return t.initEvent(n,!0,!1),t}}r=null;"undefined"==typeof window||"function"!=typeof getComputedStyle?((r=function(n){return n}).destroy=function(n){return n},r.update=function(n){return n}):((r=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],function(n){return o(n)}),n}).destroy=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],s),n},r.update=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],h),n});t.default=r;n.exports=t.default});ICommand.prototype.execute=function(){};ICommand.prototype.isMyCommand=function(){};ImgCommand.prototype=new ICommand;ImgCommand.prototype.constructor=ImgCommand;ImgCommand.prototype.execute=function(){var t,i,n,r,u,f;for(this.originalResponseText=this.controller.chatter.botText,t=this.originalResponseText,i=0;i<this.responseText.length;i++)n=this.responseText[i],r="",r=this.getParameter("url",n).startsWith("./")?this.getParameter("url",n).replace("./",location.protocol+"//"+location.host+"/"+rootDir+"/"):this.getParameter("url",n),u=this.getParameter("width",n),f=this.getParameter("height",n),t=t.replace(n,'<div><div style="position: relative;"><a href="'+r+'" rel="lightbox" style="position: relative;" target="_blank"><img src="'+r+'" width="'+u+'" height="'+f+'" /><\/a><\/div><\/div>');this.controller.chatter.botText=t};ImgCommand.prototype.isMyCommand=function(){var u,i,n,r,t;for(this.originalResponseText=this.controller.chatter.botText,u=/(\[c\:img[^\[\]]*)+(\s*\[[^\[\]]*\]\s*)*([^\[\]]*\])*/g,i=[];(n=u.exec(this.originalResponseText))!==null;)if(r="",n!=null&&n.length>1){for(t=1;t<n.length;t++)n[t]!=undefined&&(r+=n[t]);i.push(r)}return this.executeCommand=i.length>0,this.executeCommand&&(this.responseText=i),this.executeCommand};ImgCommand.prototype.getParameter=function(n,t){var r=new RegExp(n+"=([^#=]*)[=|\\]]"),i=r.exec(t);return i===null?"":i[1].replace(/url|width|height/g,"")};PhoneCommand.prototype=new ICommand;PhoneCommand.prototype.constructor=PhoneCommand;PhoneCommand.prototype.execute=function(){this.originalResponseText=controller.chatter.botText;var n=this.originalResponseText;n.includes("[c:phone]")&&(n=n.split("[c:phone]")[0]);this.controller.chatter.botText=n};PhoneCommand.prototype.isMyCommand=function(){var u,i,n,r,t;for(this.originalResponseText=this.controller.chatter.botText,u=/(\[c\:phone\]*)+(\s*\[[^\[\]]*\]\s*)*([^\[\]]*\])*/gi,i=[];(n=u.exec(this.originalResponseText))!==null;)if(r="",n!=null&&n.length>1){for(t=1;t<n.length;t++)n[t]!=undefined&&(r+=n[t]);i.push(r)}return this.executeCommand=i.length>0,this.executeCommand&&(this.responseText=i[0]),this.executeCommand};LinkCommand.prototype=new ICommand;LinkCommand.prototype.constructor=LinkCommand;LinkCommand.prototype.execute=function(){var i,e,t,u,f;for(this.originalResponseText=this.controller.chatter.botText,i=this.originalResponseText,e=0;e<this.responseText.length;e++){var n=this.responseText[e],o=this.getParameterUrl(n),h=this.getParameter("target",n),r=this.getParameter("value",n);if(r=r.replace(/'/g,"\\'").replace(/"/g,"&quot;"),t=this.getParameter("label",n),t.indexOf("c:img")>-1){var s=/(\[c\:img[^\[\]]*)+(\s*\[[^\[\]]*\]\s*)*([^\[\]]*\])*/g.exec(n),c=this.getParameterImg("url",s),l=this.getParameterImg("width",s),a=this.getParameterImg("height",s);t='<img src="'+c+'" width="'+l+'" height="'+a+'" />';o=""}u=this.getParameter("language",n);u===""&&(u=this.controller.chatter.userLanguage);o==""?(t==""&&(t=n.replace(/\[c:link /g,"").replace("]","")),f=t.replace(/'/g,"\\'").replace(/"/g,"&quot;"),t.indexOf("img src")>-1&&(f=r),i=r===""?i.replace(n,'<a href="javascript:;" onclick="controller.sendMessage(\''+f+"','"+f+"',true,'"+u+'\'); desativa();" class="btn btn-info mr10 mb10">'+t+"<\/a>"):i.replace(n,'<a href="javascript:;" onclick="controller.sendMessage(\''+f+"','"+r+"',true,'"+u+'\'); desativa();" class="btn btn-info mr10 mb10">'+t+"<\/a>")):i=i.replace(n,'<a href="'+o+'" target="'+h+'">'+t)}this.controller.chatter.botText=i};LinkCommand.prototype.isMyCommand=function(){var u,i,n,r,t;for(this.originalResponseText=this.controller.chatter.botText,u=/(\[c\:link[^\[\]]*)+(\s*\[[^\[\]]*\]\s*)*([^\[\]]*\])*/g,i=[];(n=u.exec(this.originalResponseText))!==null;)if(r="",n!=null&&n.length>1){for(t=1;t<n.length;t++)n[t]!=undefined&&(r+=n[t]);i.push(r)}return this.executeCommand=i.length>0,this.executeCommand&&(this.responseText=i),this.executeCommand};LinkCommand.prototype.getParameter=function(n,t){var r=new RegExp(n+"=([^#=]*)[=|\\]]"),i=r.exec(t);return i===null?"":i[1].replace(/ language| label| url| target| value/g,"")};LinkCommand.prototype.getParameterUrl=function(n){var i=new RegExp("url=([^\\s]*)[\\s|\\]]"),t=i.exec(n);return t===null?"":t[1].replace(/ language| label| url| target| value/g,"")};LinkCommand.prototype.getParameterImg=function(n,t){var r=new RegExp(n+"=([^#=]*)[=|\\]]"),i=r.exec(t);return i===null?"":i[1].replace(/url|width|height|] value/g,"")};NewLineCommand.prototype=new ICommand;NewLineCommand.prototype.constructor=NewLineCommand;NewLineCommand.prototype.execute=function(){this.originalResponseText=controller.chatter.botText;var n=this.originalResponseText;n=n.replace(/\[c\:newline\]/gi,"<br />");this.controller.chatter.botText=n};NewLineCommand.prototype.isMyCommand=function(){var u,i,n,r,t;for(this.originalResponseText=this.controller.chatter.botText,u=/(\[c\:newline\]*)+(\s*\[[^\[\]]*\]\s*)*([^\[\]]*\])*/gi,i=[];(n=u.exec(this.originalResponseText))!==null;)if(r="",n!=null&&n.length>1){for(t=1;t<n.length;t++)n[t]!=undefined&&(r+=n[t]);i.push(r)}return this.executeCommand=i.length>0,this.executeCommand&&(this.responseText=i[0]),this.executeCommand};PasswordCommand.prototype=new ICommand;PasswordCommand.prototype.constructor=PasswordCommand;PasswordCommand.prototype.execute=function(){this.controller.chatter.botText=this.controller.chatter.botText.replace("[c:password]","");controller.pw=!0};PasswordCommand.prototype.changediv=function(n){switch(n){case!0:document.getElementById("txtQuestion").type="password";break;case!1:document.getElementById("txtQuestion").type="";break;case undefined:document.getElementById("txtQuestion").type=""}};PasswordCommand.prototype.changetext=function(n){for(var t=0,i="",t=0;t<n.length;t++)i+="*";return i};PasswordCommand.prototype.isMyCommand=function(){return this.controller.chatter.botText!=undefined&&this.controller.chatter.botText.indexOf("[c:password]")!=-1?!0:!1};var filesUpload=[],lastUploadsControls=0,defaultHeight=0,multiple=!1,attempt=1,iTimer=0;UploadCommand.prototype=new ICommand;UploadCommand.prototype.constructor=UploadCommand;UploadCommand.prototype.execute=function(){var i,t,r,n;for(this.originalResponseText=this.controller.chatter.botText,i=this.originalResponseText,t=0;t<this.responseText.length;t++)r=this.responseText[t],n="",multiple=!1,attempt=attempt>controller.chatter.uploadFileParameters.fileMaxAttempt?1:attempt,r.indexOf("multiple=true")!=-1&&(multiple=!0),filesUpload=[],lastUploadsControls++,lastCommand=this.responseText[t],$("#txtQuestion").prop("disabled",!0),$("#btnSend").prop("disabled",!0),n+="<br />",attempt>1&&(n+='<span style="color:red;">'+controller.chatter.uploadFileParameters.fileAttemptAlert+"<\/span>"),n+='<br /><div id="filesToUpload'+lastUploadsControls+'" style="height: 0px;overflow-y:auto;"><\/div>',n+='<input class="btn btn-info mr10 mb10" type="button" id="btSelectFiles'+lastUploadsControls+'" '+(multiple?'value="'+translation[this.userLang].selectFiles+'"':'value="'+translation[this.userLang].selectFile+'"')+'" onclick="javascript:if(checkActualControl('+lastUploadsControls+")) userFile"+lastUploadsControls+'.click(); " >',n+='<input class="btn btn-info mr10 mb10" style="display:none" id="userFile'+lastUploadsControls+'" name="userFile'+lastUploadsControls+'" onchange="changeFileList('+lastUploadsControls+'); " type="file"  '+(multiple?'multiple="multiple"':"")+' "/>',n+='<input class="btn btn-info mr10 mb10" id="formsubmit'+lastUploadsControls+'" type="submit" onclick="uploadFiles('+lastUploadsControls+'); return false;"'+(multiple?'value="'+translation[this.userLang].sendFiles+'"':'value="'+translation[this.userLang].sendFile+'"')+" />",n+='<input class="btn btn-danger mr10 mb10" id="btNotSend'+lastUploadsControls+'" type="button" onclick="notSend('+lastUploadsControls+');" value="'+translation[this.userLang].cancel+'" />',n+="<br />",n+='<div id="error'+lastUploadsControls+'" style="color:red;display:none;"><\/div>',n+="<br />",n+='<div style="width:20%; margin:0;"><div class="progress" id="progressbar'+lastUploadsControls+'" style="display:none;width:100%;"><div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width:0%">0%<\/div><\/div><\/div>',i=i.replace(r,n);this.controller.chatter.botText=i};UploadCommand.prototype.isMyCommand=function(){var u,i,n,r,t;for(this.originalResponseText=this.controller.chatter.botText,u=/(\[c\:upload[^\[\]]*)+(\s*\[[^\[\]]*\]\s*)*([^\[\]]*\])*/g,i=[];(n=u.exec(this.originalResponseText))!==null;)if(r="",n!=null&&n.length>1){for(t=1;t<n.length;t++)n[t]!=undefined&&(r+=n[t]);i.push(r)}return this.executeCommand=i.length>0,this.executeCommand&&(this.responseText=i),this.executeCommand};UploadCommand.prototype.getParameter=function(n,t){var r=new RegExp(n+"=([^#=]*)[=|\\]]"),i=r.exec(t);return i===null?"":i[1].replace(/label|url|target/g,"")};UploadCommand.prototype.getParameterUrl=function(n){var i=new RegExp("url=([^#\\s]*)[\\s|\\]]"),t=i.exec(n);return t===null?"":t[1].replace(/label|url|target/g,"")};MultiSelectCommand.prototype=new ICommand;MultiSelectCommand.prototype.constructor=MultiSelectCommand;MultiSelectCommand.prototype.execute=function(){var r,u;this.originalResponseText=controller.chatter.botText;var n=this.originalResponseText,e=n,t="<br />",f=this.getParameter("values",e),i=f.toString();for(i=i.split(";"),$("input").removeClass("OptionsTag"),r=0;r<i.length;r++)u=i[r].trim(),t+='<div class="checkbox"><label class="OptionsLabelTag"><input class="OptionsTag" onclick = "MultiSelect()" type = "checkbox" value = "'+u+'" ><span class="ckboxLabel">&ensp;'+u+"<\/span><\/label><\/div>";t+='<div><input class="btn btn-info mr10 mb10 btnQuestionSubmit" type="submit" onclick="sendQuestions(); return false;" value="'+translation[this.userLang].sendQuestions+'">';t+='<input class="btn btn-danger mr10 mb10 btnQuestionCancel" type="submit" onclick="cancelQuestions(); return false;" value="'+translation[this.userLang].cancel+'"><\/div>';n=n.replace("[c:multiselect values="+f+"]",t);eventDisableComponents(!0);this.controller.chatter.botText=n};MultiSelectCommand.prototype.getParameter=function(n,t){var r=new RegExp(n+"=([^#=]*)[=|\\]]"),i=r.exec(t);return i===null?"":i[1].replace(/label|url|target|value/g,"")};MultiSelectCommand.prototype.isMyCommand=function(){var u,i,n,r,t;for(this.originalResponseText=this.controller.chatter.botText,u=/(\[c\:multiselect\]*)+(\s*\[[^\[\]]*\]\s*)*([^\[\]]*\])*/gi,i=[];(n=u.exec(this.originalResponseText))!==null;)if(r="",n!=null&&n.length>1){for(t=1;t<n.length;t++)n[t]!=undefined&&(r+=n[t]);i.push(r)}return this.executeCommand=i.length>0,this.executeCommand&&(this.responseText=i[0]),this.executeCommand}